---
title: "ä¸€å¼€å§‹åªæ˜¯æƒ³åŠ ä¸€ä¸ª enum"
date: 2026-02-03
---


[Nature ç¼–ç¨‹è¯­è¨€](https://nature-lang.cn/)ä¸€ç›´è®¡åˆ’æ·»åŠ  enum ç±»å‹ï¼Œæ¯•ç«Ÿ Go æ²¡æœ‰ enum æ˜¯ä¸€ç›´è¢«è¯Ÿç—…çš„é—®é¢˜ï¼Œè€Œ Rust çš„ enum è®¾è®¡å¦‚æ­¤å¼ºå¤§ï¼Œæ‰€ä»¥æˆ‘æœ‰äº›çº ç»“æ˜¯å¦éœ€è¦åœ¨ enum ä¸Šæ‰©å±•å‡º ADT ç»“æ„ã€‚æœ€ç»ˆæˆ‘é€‰æ‹©å…ˆè®¾è®¡ä¸€ä¸ªåŸºç¡€çš„ enumï¼Œåç»­è‹¥æœ‰éœ€æ±‚å†æ‰©å±•ä¸º ADT å½¢å¼çš„ enumã€‚è¿™æ˜¯åŸºç¡€è¯­æ³•è®¾è®¡

```nature
type color = enum{
    RED = 1, // Counting starts from 1
    GREEN,
    BLUE,
}

// è‡ªå®šä¹‰åŸºç¡€ç±»å‹
type color = enum:i32{
    RED = 1, // Counting starts from 1
    GREEN,
    BLUE,
}

fn color.to_string(self):string {
	match self {
        color.RED -> 'red'
        color.GREEN -> 'green'
        color.BLUE -> 'blue'
    }
}

// Usage example
var c = color.RED
print(c.to_string())
```

ä½†å®ŒæˆåŸºç¡€ enum å¼€å‘åï¼Œæˆ‘å¿½ç„¶æœ‰ç‚¹è´ªå¿ƒï¼Œç°åœ¨ AI è¿™ä¹ˆå‰å®³ (à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ ä¸å¦‚ç›´æ¥è®© AI æŠŠ ADT enum ä¹ŸåŠ ä¸Šå¥½äº†ï¼Œäºæ˜¯æˆ‘å‚è€ƒ Rustã€Swift è®¾è®¡å‡ºäº†è¿™æ ·çš„è¯­æ³•

```js
type option = enum{  
    some(int),  // åªæ”¯æŒ tuple ç»„åˆï¼Œä¸æ”¯æŒ struct
    none,  
}  
  
fn main() {  
    var opt = option.some(100)  
    var value = match opt {  
        option.some(v) -> v  
        option.none -> -1  
    }  
    assert(value == 100)  
  
    var opt2 = option.none  
    value = match opt2 {  
       option.some(v) -> v  
       option.none -> -1  
    }  
    assert(value == -1)  
}
```

AI ç»è¿‡ä¸€å¤©ä¸€å¤œçš„åŠªåŠ›ï¼ŒClaude Opus 4.5 è€—å…‰äº†æˆ‘ Antigravity ä¸¤ä¸ªè´¦å·çš„å‘¨ä½¿ç”¨é™é¢ï¼Œå´è¿ä¸€ä¸ªèƒ½ç¼–è¯‘æˆåŠŸçš„ç”¨ä¾‹éƒ½æ²¡è·‘å‡ºæ¥ ğŸ¤¦â€â™‚ï¸ï¼Œçœ‹æ¥è¿™ç§å¤æ‚ä»»åŠ¡å¯¹å®ƒæ¥è¯´è¿˜æ˜¯æœ‰äº›åƒåŠ›ã€‚

![](https://raw.githubusercontent.com/weiwenhao/pictures/main/20260203211650846.png)

ä¸è¿‡ AI å·²ç»å†™äº†ä¸å°‘ä»£ç ï¼Œç»è¿‡æˆ‘åˆä¸€å¤©çš„ä¿®ä¿®è¡¥è¡¥ï¼Œç»ˆäºæˆåŠŸè¿è¡Œèµ·æ¥ã€‚ä½†æ˜¯ç»è¿‡è¿™ä¸¤å¤©çš„æ¥è§¦ï¼Œæˆ‘è¶Šå‘è§‰å¾—è¿™ç§è®¾è®¡åœ¨ Nature ä¸­ä¸å¤Ÿåè°ƒï¼Œå°¤å…¶æ˜¯ç±»ä¼¼ `write(string)` è¿™æ ·çš„è¡¨è¾¾æ–¹å¼éå¸¸çš„å¥‡æ€ªï¼ŒNature ä¸­æ‰¾ä¸åˆ°ä»»ä½•çš„è¯­æ³•èƒ½å¤Ÿå¯¹åº”è¿™ç§è¡¨è¾¾æ–¹å¼ã€‚å¹¶ä¸”å¢åŠ  ADT enum åï¼ŒNature æ•´ä½“çš„å­¦ä¹ æ›²çº¿ä¼šè¿›ä¸€æ­¥æå‡ï¼Œè¿™ä¸ Nature ç®€æ´ä¼˜é›…çš„è®¾è®¡ç†å¿µç›¸å†²çªã€‚äºæ˜¯æˆ‘ç‹ ä¸‹å¿ƒæ¥ï¼Œæ‰“ç®—ç›´æ¥æ”¾å¼ƒè¿™ä¸ªåŠŸèƒ½ï¼Œæ¯•ç«Ÿ AI å†™çš„ä»£ç ä¸¢æ‰æˆ‘ä¹Ÿä¸å¿ƒç–¼ ğŸš®

ä½†è¿˜æ˜¯æœ‰äº›ä¸ç”˜å¿ƒï¼Œäºæ˜¯æˆ‘ç»§ç»­è°ƒç ”æ‰€æœ‰æ”¯æŒ ADT çš„ç¼–ç¨‹è¯­è¨€ï¼Œå¸Œæœ›èƒ½ä»ä¸­æ‰¾åˆ°ä¸€äº›çµæ„Ÿï¼Œæ¯”å¦‚ Haskell, Ocam, Swift, Kotlin, Zig ç­‰ç­‰ï¼Œè¿™é‡Œä¸å¾—ä¸æ Rust çš„ ADT enum è®¾è®¡ï¼ŒåŸºäºå…¶çµæ´»çš„ struct è®¾è®¡ï¼Œé…åˆ match è¯­æ³•ä½¿ç”¨éå¸¸è‡ªç„¶ã€‚

```rust
enum Message {
    Quit,                       // struct Quit;
    Move { x: i32, y: i32 },    // struct Move { x: i32, y: i32 };
    Write(String),              // struct Write(String);
    ChangeColor(i32, i32, i32), // struct ChangeColor(i32, i32, i32);
}


match msg {
    Message::Quit => {
        println!("Quit variant has no data.");
    }
    Message::Move { x, y } => {
        println!("Move to x: {}, y: {}", x, y);
    }
    Message::Write(text) => {
        println!("Text message: {}", text);
    }
    Message::ChangeColor(r, g, b) => {
        println!("Change color to R:{}, G:{}, B:{}", r, g, b);
    }
}
```

è™½ç„¶ Nature ä»…é‡‡ç”¨äº† tuple æ¨¡å¼ï¼Œä¸ Swift ç±»ä¼¼ã€‚æˆ‘å¯ä»¥è§£é‡Šè¿™æ˜¯ enum + union + tuple ç»„åˆè€Œæˆçš„è¯­æ³•è®¾è®¡ï¼Œä½†è¿˜æ˜¯æ¯”è¾ƒçªå…€ã€‚å¹¶ä¸”æœ‰ä¸€ä¸ªå…³é”®é—®é¢˜ï¼ŒNature ä¸­å·²ç»å­˜åœ¨äº†ç®€å•çš„ union ç±»å‹è®¾è®¡ï¼Œè¿™æœ¬è´¨å°±æ˜¯ä¸€ç§ç®€åŒ–çš„ ADTï¼Œnature çš„ `Option<T>` å’Œ `Result<T, E>` ä¹Ÿæ˜¯åŸºäºè¯¥ union è®¾è®¡ï¼Œè¯­æ³•ç¤ºä¾‹å¦‚ä¸‹

```js
type shape = int|float

type nullable<T> = T|null
type throwable<T> = T|error

fn main() {
	shape s = 12
	if s is int v { // auto insert var v = s as int
		println(s)
	}
	
	var val = match s {
		is int v -> v
		_ -> 0
	}
}
```

å¢åŠ  ADT enum å’Œå·²æœ‰çš„ union è¯­æ³•åœ¨è¡¨è¾¾ä¸Šå­˜åœ¨å†²çªï¼Œå¹¶ä¸”æ— æ³•ä½¿ç”¨ if åŒ¹é… ADT enumï¼Œæ¯”å¦‚ Rust ä¸­çš„ `if let Some(u) = temp` ï¼Œ è€Œ Nature ä¸­å¹¶æ²¡æœ‰ç±»ä¼¼çš„è§£æ„æ–¹å¼ï¼Œåè€ŒåŸºäº union çš„ is å¯ä»¥è¿›è¡Œè§£æ„ï¼Œæ¯”å¦‚ `if s is int v`ã€‚

äºæ˜¯æˆ‘é‡æ–°æ€è€ƒå¦‚ä½•è®¾è®¡ä¸€ä¸ªæ›´åŠ è‡ªç„¶çš„ ADT è¯­æ³•ã€‚åœ¨å‚è€ƒäº†å¤§é‡çš„ç¼–ç¨‹è¯­è¨€åï¼Œæœ€ç»ˆå†³å®šè¿˜æ˜¯è¿›ä¸€æ­¥å¢å¼ºç°æœ‰çš„ unionï¼Œè€Œä¸æ˜¯åŸºäº enum ä»æ–°è®¾è®¡ã€‚ç°æœ‰çš„ union ç±»å‹æ— æ³•åº”å¯¹å¤æ‚åœºæ™¯ï¼Œæ¯”å¦‚ `type shape = int|int|(int, int)|foo_t` è¿™ç±»å­˜åœ¨é‡å¤ç±»å‹çš„æƒ…å†µï¼Œè™½ç„¶å¯ä»¥é€šè¿‡å®šä¹‰ struct è§£å†³ï¼Œä½†ç»ˆç©¶è¿˜æ˜¯è¿‡äºç¹çã€‚

ä¸ºç°æœ‰çš„ union çš„å¢åŠ  tag ä¸ä»…å¤Ÿè§£å†³ç›¸å…³é—®é¢˜ï¼Œå¹¶ä¸”å¾—åˆ°ä¸€ä¸ªå®Œæ•´çš„ ADT ç±»å‹ï¼Œç¬¬ä¸€ç‰ˆè¯­æ³•è®¾è®¡ç±»ä¼¼äº haskell

```nature
type nullable<T> = 
| none
| ok(T)
```

è¯­æ³•ä¸Šè™½ç„¶ç®€æ´ï¼Œä½†æ˜¯å­˜åœ¨ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œ`|` è¡¨è¾¾å¼ä¸æ˜¯å°é—­çš„ï¼Œok(T) å’Œ none åœ¨è¯­ä¹‰ä¸Šå…·æœ‰å…¨å±€æ€§ï¼Œä¸å— nullable çš„çº¦æŸã€‚ä¹Ÿå°±æ˜¯ `nullable.none` å’Œ `none` çš„åŒºåˆ«ã€‚

ç±»ä¼¼ struct/enum ä½¿ç”¨çš„ `{}` å£°æ˜æ–¹å¼åˆ™æ˜¯å°é—­çš„ä¸”å…·æœ‰çº¦æŸæ€§ï¼Œå› æ­¤å¾—åˆ°äº†å¦‚ä¸‹çš„è¯­æ³•è®¾è®¡ï¼Œæˆ‘ç§°ä¹‹ä¸º tagged unionã€‚å¹¶ä¸”ç®€åŒ–äº† tagged union çš„åˆå§‹åŒ–æ–¹å¼ï¼Œå¯¹ tuple ç±»å‹å¯ä»¥è‡ªç„¶çš„è¿›è¡Œè§£æ„ã€ä»¥åŠ match ç©·å°½æ£€æŸ¥ç­‰ç­‰ã€‚

```nature
type ellipse_t = struct{  
    int rx  
    int ry  
}  
  
type shape = union{  
    int circle  
    int square  
    (int, int) rectangle  
    ellipse_t ellipse  
    void point
}

// ä¼ ç»Ÿ c like union èµ‹å€¼
// shape s = shape{sllipse: ellipse_t{rx:1, ry:2}}
// nature ä¸­é‡‡ç”¨ç®€åŒ–çš„èµ‹å€¼æ–¹å¼
shape s = shape.ellipse(ellipse_t{rx:1, ry:2})

// shape s = shape.rectangle((1, 2))
// è¿™é‡Œä¸¤ä¸ªæ‹¬å·æœ‰äº›å¤šä½™äº†ï¼Œæ‰€ä»¥å¯¹ tuple ç±»å‹çš„åˆå§‹åŒ–è¿›è¡Œäº†ä¼˜åŒ–å¤„ç†ï¼Œå½“ç„¶åŸæœ‰æ–¹å¼ä¹Ÿæ˜¯æ”¯æŒçš„ã€‚
shape s2 = shape.rectangle(1, 2)

// åŸºäºåŸæœ‰çš„ is union T çš„æ–¹å¼ï¼Œæ‰©å±•ä¸º is union tag
if s is shape.ellipse v { 
	// auto insert: v = s as shape.sllips
	println(v.rx, v.ry)
}

// nature çš„ tup æ”¯æŒç»“æ„èµ‹å€¼ï¼Œç­‰åŒäº if s is shape.rectangle v 
// s is shape.rectangle (x, y) æ˜¯ç­‰æ•ˆçš„ã€‚
// s is shape.rectangle(x, y) åŒä¸Š
if s2 is shape.rectangle (x, y) {
	// auto insert var (x, y) = s as shape.rectangle
}

var v = match s { // match å¯¹ union tag ä¼šè¿›è¡Œç©·å°½æ£€æŸ¥
	is m.shape.circle v -> v * PI * PI
	is shape.square v -> v * v
	is shape.rectangle(width, height) -> width * height // tuple è‡ªåŠ¨è§£æ„
	is shape.ellipse v -> v.rx * v.r * PI
	is shape.point -> 0
}

```

å°†ç±»å‹è®¾ä¸º void å¯ä»¥å¾ˆè‡ªç„¶çš„è¡¨ç¤ºä»…ä½¿ç”¨æ ‡ç­¾æ— éœ€å…³è”å€¼çš„æƒ…å†µï¼ŒZig çš„ ADT ä¹Ÿé‡‡ç”¨äº†ç±»ä¼¼ç­–ç•¥ã€‚tagged union åŒæ ·æ”¯æŒæ³›å‹å’Œ impl

```nature
type result<T> = union{  
    T some  
    void none  
}

fn result.to_string():string {
    return match self {
        is result.some -> 'some'
        is result.none -> 'none'
    }
}

fn main() {
	// å¦‚æœ r çš„ç±»å‹å·²çŸ¥ï¼Œåˆ™å¯ä»¥è¿›è¡Œæ³›å‹ç±»å‹çš„ç®€å•æ¨å¯¼
	// result<T> r = result.some(123)
    var r = result<int>.some(123)  
    if r is result.some v {  
        assert(v == 123)  
    } else {  
        assert(false)  
    }
    
    r = result<int>.some(352)  
	match r {  
	    is result.some v -> {
	        assert(v == 352)  
	    }  
	    is result.none -> {
	        assert(false)  
	    }
	}
}
```
ç»è¿‡è¿™ä¸€æ³¢ä¸‰æŠ˜ï¼ŒAI æ¨¡å‹çš„ä½¿ç”¨é¢åº¦å·²è€—å°½ï¼Œæˆ‘åªèƒ½é€šè¿‡â€œå¤æ³•ç¼–ç¨‹â€å®ç°è¿™ä¸ªæ–¹æ¡ˆ ğŸ§‘â€ğŸ’»ï¼Œå†ä¸€æ¬¡ç»è¿‡ä¸¤å¤©çš„å¥‹æ–—å®Œæˆäº†ç›¸å…³çš„å¼€å‘å¹¶åˆå¹¶åˆ°äº† master åˆ†æ”¯ã€‚ç›¸å…³æ–‡æ¡£å°†ä¼šåœ¨æ–°çš„å¤§ç‰ˆæœ¬å‘å¸ƒæ—¶æ›´æ–°ã€‚å¯ä»¥å‚è€ƒçš„æµ‹è¯•ç”¨ä¾‹ [20260201_00_tagged_union.testar](https://github.com/nature-lang/nature/blob/master/tests/features/cases/20260201_00_tagged_union.testar)
